<!--pages/manager/statistics/statistics.wxml-->
<view class="statistics-page">
  <!-- é¡¶éƒ¨ä»Šæ—¥ç»Ÿè®¡å¡ç‰‡ -->
  <view class="today-stats">
    <view class="stats-card">
      <view class="stats-icon new">ğŸ“</view>
      <view class="stats-content">
        <text class="stats-number">{{todayStats.newIssues}}</text>
        <text class="stats-label">ä»Šæ—¥æ–°å¢</text>
      </view>
    </view>
    
    <view class="stats-card">
      <view class="stats-icon resolved">âœ…</view>
      <view class="stats-content">
        <text class="stats-number">{{todayStats.resolvedToday}}</text>
        <text class="stats-label">ä»Šæ—¥è§£å†³</text>
      </view>
    </view>
    
    <view class="stats-card">
      <view class="stats-icon pending">â°</view>
      <view class="stats-content">
        <text class="stats-number">{{todayStats.pendingIssues}}</text>
        <text class="stats-label">å¾…å¤„ç†</text>
      </view>
    </view>
  </view>

  <!-- æ€»ä½“ç»Ÿè®¡ -->
  <view class="overall-stats">
    <view class="section-title">æ€»ä½“æ¦‚å†µ</view>
    <view class="overall-cards">
      <view class="overall-card">
        <text class="overall-number">{{totalIssues}}</text>
        <text class="overall-label">æ€»é—®é¢˜æ•°</text>
      </view>
      <view class="overall-card">
        <text class="overall-number">{{totalWorkers}}</text>
        <text class="overall-label">ç»´ä¿®å·¥æ•°</text>
      </view>
      <view class="overall-card">
        <text class="overall-number">{{avgResolveTime}}h</text>
        <text class="overall-label">å¹³å‡è§£å†³</text>
      </view>
      <view class="overall-card">
        <text class="overall-number">{{avgSatisfaction}}</text>
        <text class="overall-label">å¹³å‡è¯„åˆ†</text>
      </view>
    </view>
  </view>

  <!-- çŠ¶æ€ç»Ÿè®¡ -->
  <view class="status-stats">
    <view class="section-title">é—®é¢˜çŠ¶æ€åˆ†å¸ƒ</view>
    <view class="status-list">
      <view class="status-item" bindtap="onGoToPending">
        <view class="status-info">
          <text class="status-name">å¾…å¤„ç†</text>
          <text class="status-count">{{statusStats.pending}}</text>
        </view>
        <view class="status-bar">
          <view class="status-bar-fill" style="width: {{statusStats.pending / totalIssues * 100}}%; background: #fa8c16;"></view>
        </view>
      </view>
      
      <view class="status-item" bindtap="onGoToAssigned">
        <view class="status-info">
          <text class="status-name">å·²åˆ†é…</text>
          <text class="status-count">{{statusStats.assigned}}</text>
        </view>
        <view class="status-bar">
          <view class="status-bar-fill" style="width: {{statusStats.assigned / totalIssues * 100}}%; background: #1890ff;"></view>
        </view>
      </view>
      
      <view class="status-item">
        <view class="status-info">
          <text class="status-name">å¤„ç†ä¸­</text>
          <text class="status-count">{{statusStats.processing}}</text>
        </view>
        <view class="status-bar">
          <view class="status-bar-fill" style="width: {{statusStats.processing / totalIssues * 100}}%; background: #722ed1;"></view>
        </view>
      </view>
      
      <view class="status-item" bindtap="onGoToResolved">
        <view class="status-info">
          <text class="status-name">å·²è§£å†³</text>
          <text class="status-count">{{statusStats.resolved}}</text>
        </view>
        <view class="status-bar">
          <view class="status-bar-fill" style="width: {{statusStats.resolved / totalIssues * 100}}%; background: #52c41a;"></view>
        </view>
      </view>
      
      <view class="status-item">
        <view class="status-info">
          <text class="status-name">å·²å…³é—­</text>
          <text class="status-count">{{statusStats.closed}}</text>
        </view>
        <view class="status-bar">
          <view class="status-bar-fill" style="width: {{statusStats.closed / totalIssues * 100}}%; background: #666;"></view>
        </view>
      </view>
    </view>
  </view>

  <!-- ä¼˜å…ˆçº§ç»Ÿè®¡ -->
  <view class="priority-stats">
    <view class="section-title">ä¼˜å…ˆçº§åˆ†å¸ƒ</view>
    <view class="priority-grid">
      <view class="priority-card urgent">
        <text class="priority-count">{{priorityStats.urgent}}</text>
        <text class="priority-label">ç´§æ€¥</text>
      </view>
      <view class="priority-card high">
        <text class="priority-count">{{priorityStats.high}}</text>
        <text class="priority-label">é«˜</text>
      </view>
      <view class="priority-card medium">
        <text class="priority-count">{{priorityStats.medium}}</text>
        <text class="priority-label">ä¸­</text>
      </view>
      <view class="priority-card low">
        <text class="priority-count">{{priorityStats.low}}</text>
        <text class="priority-label">ä½</text>
      </view>
    </view>
  </view>

  <!-- ç±»åˆ«ç»Ÿè®¡ -->
  <view class="category-stats" wx:if="{{categoryList.length > 0}}">
    <view class="section-title">é—®é¢˜ç±»åˆ«åˆ†å¸ƒ</view>
    <view class="category-list">
      <view class="category-item" wx:for="{{categoryList}}" wx:key="name">
        <view class="category-info">
          <text class="category-name">{{item.name}}</text>
          <text class="category-count">{{item.count}}</text>
        </view>
        <view class="category-bar">
          <view class="category-bar-fill" style="width: {{item.count / totalIssues * 100}}%;"></view>
        </view>
      </view>
    </view>
  </view>

  <!-- ç»´ä¿®å·¥è¡¨ç°ç»Ÿè®¡ -->
  <view class="worker-stats" wx:if="{{workerStats.length > 0}}">
    <view class="section-title">ç»´ä¿®å·¥è¡¨ç°</view>
    <view class="worker-list">
      <view class="worker-item" wx:for="{{workerStats}}" wx:key="workerId">
        <view class="worker-header">
          <text class="worker-name">{{item.workerName}}</text>
          <text class="worker-satisfaction">â­ {{item.avgSatisfaction}}</text>
        </view>
        <view class="worker-stats-row">
          <view class="worker-stat">
            <text class="stat-label">æ€»ä»»åŠ¡</text>
            <text class="stat-value">{{item.totalTasks}}</text>
          </view>
          <view class="worker-stat">
            <text class="stat-label">å·²å®Œæˆ</text>
            <text class="stat-value">{{item.completedTasks}}</text>
          </view>
          <view class="worker-stat">
            <text class="stat-label">è¿›è¡Œä¸­</text>
            <text class="stat-value">{{item.inProgressTasks}}</text>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty-state" wx:if="{{totalIssues === 0 && !isLoading}}">
    <text class="empty-icon">ğŸ“Š</text>
    <text class="empty-text">æš‚æ— ç»Ÿè®¡æ•°æ®</text>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading-state" wx:if="{{isLoading}}">
    <text>åŠ è½½ä¸­...</text>
  </view>
</view>