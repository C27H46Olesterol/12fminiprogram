<!--pages/manager/worker-applications/worker-applications.wxml-->
<view class="container">
  <!-- å¤´éƒ¨ -->
  <view class="header">
    <view class="title">ç»´ä¿®å·¥ç”³è¯·ç®¡ç†</view>
    <view class="subtitle">å®¡æ ¸ç”³è¯·ï¼Œç®¡ç†ç»´ä¿®å›¢é˜Ÿ</view>
  </view>

  <!-- çŠ¶æ€ç­›é€‰ -->
  <view class="filter-tabs">
    <view 
      class="tab-item {{statusFilter === 'all' ? 'active' : ''}}" 
      bindtap="onFilterChange"
      data-status="all"
    >
      å…¨éƒ¨
      <text class="badge" wx:if="{{allCount > 0}}">{{allCount}}</text>
    </view>
    <view 
      class="tab-item {{statusFilter === 'pending' ? 'active' : ''}}" 
      bindtap="onFilterChange"
      data-status="pending"
    >
      å¾…å®¡æ ¸
      <text class="badge pending" wx:if="{{pendingCount > 0}}">{{pendingCount}}</text>
    </view>
    <view 
      class="tab-item {{statusFilter === 'approved' ? 'active' : ''}}" 
      bindtap="onFilterChange"
      data-status="approved"
    >
      å·²é€šè¿‡
    </view>
    <view 
      class="tab-item {{statusFilter === 'rejected' ? 'active' : ''}}" 
      bindtap="onFilterChange"
      data-status="rejected"
    >
      å·²æ‹’ç»
    </view>
  </view>

  <!-- ç”³è¯·åˆ—è¡¨ -->
  <view class="applications-list">
    <view 
      class="application-card" 
      wx:for="{{applications}}" 
      wx:key="applicationId"
    >
      <!-- ç”³è¯·äººä¿¡æ¯ -->
      <view class="app-header">
        <view class="app-info">
          <view class="app-name">{{item.applicantName}}</view>
          <view class="app-phone">{{item.applicantPhone}}</view>
        </view>
        <view class="app-status status-{{item.status}}">
          {{item.statusText}}
        </view>
      </view>

      <!-- é—¨åº—ä¿¡æ¯ -->
      <view class="app-details">
        <view class="detail-item">
          <text class="label">æ‰€åœ¨åœ°åŒºï¼š</text>
          <text class="value">{{item.province}} - {{item.city}}</text>
        </view>
        <view class="detail-item" wx:if="{{item.storeName}}">
          <text class="label">é—¨åº—åç§°ï¼š</text>
          <text class="value">{{item.storeName}}</text>
        </view>
        <view class="detail-item" wx:if="{{item.region}}">
          <text class="label">æ‰€åœ¨åœ°åŒºï¼š</text>
          <text class="value">{{item.region}}</text>
        </view>
        <view class="detail-item" wx:if="{{item.experience}}">
          <text class="label">å·¥ä½œç»éªŒï¼š</text>
          <text class="value">{{item.experience}}</text>
        </view>
        <view class="detail-item">
          <text class="label">ç”³è¯·æ—¶é—´ï¼š</text>
          <text class="value">{{item.submitTimeText}}</text>
        </view>
      </view>

      <!-- é—¨å¤´ç…§ç‰‡ -->
      <view class="app-image">
        <view class="image-label">é—¨å¤´ç…§ç‰‡ï¼š</view>
        <image 
          class="store-image" 
          src="{{item.storeImage}}" 
          mode="aspectFill"
          bindtap="onPreviewImage"
          data-url="{{item.storeImage}}"
        />
      </view>

      <!-- æ“ä½œæŒ‰é’® -->
      <view class="app-actions" wx:if="{{item.status === 'pending'}}">
        <button 
          class="btn btn-reject" 
          bindtap="onReject"
          data-id="{{item.applicationId}}"
          data-name="{{item.applicantName}}"
        >
          æ‹’ç»
        </button>
        <button 
          class="btn btn-approve" 
          bindtap="onApprove"
          data-id="{{item.applicationId}}"
          data-name="{{item.applicantName}}"
        >
          é€šè¿‡
        </button>
      </view>

      <!-- å·²å¤„ç†ä¿¡æ¯ -->
      <view class="app-result" wx:if="{{item.status !== 'pending'}}">
        <view class="result-info">
          <text class="result-label">å¤„ç†äººï¼š</text>
          <text class="result-value">{{item.handlerName}}</text>
        </view>
        <view class="result-info">
          <text class="result-label">å¤„ç†æ—¶é—´ï¼š</text>
          <text class="result-value">{{item.handleTimeText}}</text>
        </view>
        <view class="result-info" wx:if="{{item.rejectReason}}">
          <text class="result-label">æ‹’ç»åŸå› ï¼š</text>
          <text class="result-value">{{item.rejectReason}}</text>
        </view>
      </view>
    </view>

    <!-- ç©ºçŠ¶æ€ -->
    <view class="empty-state" wx:if="{{applications.length === 0 && !isLoading}}">
      <text class="empty-icon">ğŸ“‹</text>
      <text class="empty-text">æš‚æ— ç”³è¯·è®°å½•</text>
    </view>

    <!-- åŠ è½½æ›´å¤š -->
    <view class="load-more" wx:if="{{hasMore && applications.length > 0}}">
      <text class="load-text" wx:if="{{!isLoadingMore}}">åŠ è½½æ›´å¤š</text>
      <text class="load-text" wx:else>åŠ è½½ä¸­...</text>
    </view>
  </view>
</view>

