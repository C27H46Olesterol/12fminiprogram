<!--pages/manager/index/index.wxml-->
<view class="manager-home">
  <!-- ç”¨æˆ·ä¿¡æ¯å¡ç‰‡ -->
  <view class="user-card">
    <view class="user-info">
      <image class="avatar" src="/images/app-icon.svg" mode="aspectFill"></image>
      <view class="user-details">
        <text class="user-name">{{userInfo.name}}</text>
        <text class="user-role">ä¸»ç®¡</text>
      </view>
    </view>
    <view class="user-actions">
      <button class="btn btn-outline btn-small" bindtap="onLogout">é€€å‡º</button>
    </view>
  </view>

  <!-- æ•°æ®æ¦‚è§ˆ -->
  <view class="overview-section">
    <view class="section-title">æ•°æ®æ¦‚è§ˆ</view>
    <view class="overview-cards">
      <view class="overview-card pending">
        <view class="card-icon">â³</view>
        <view class="card-content">
          <text class="card-number">{{overviewData.pending}}</text>
          <text class="card-label">å¾…å¤„ç†</text>
        </view>
      </view>
      
      <view class="overview-card assigned">
        <view class="card-icon">ğŸ‘·</view>
        <view class="card-content">
          <text class="card-number">{{overviewData.assigned}}</text>
          <text class="card-label">å·²åˆ†é…</text>
        </view>
      </view>
      
      <view class="overview-card resolved">
        <view class="card-icon">âœ…</view>
        <view class="card-content">
          <text class="card-number">{{overviewData.resolved}}</text>
          <text class="card-label">å·²è§£å†³</text>
        </view>
      </view>
    </view>
  </view>

  <!-- å¿«æ·æ“ä½œ -->
  <view class="quick-actions">
    <view class="action-item action-item-full" bindtap="onGoPending">
      <view class="action-icon pending-icon">
        <text class="icon">ğŸ“‹</text>
        <view class="badge-count" wx:if="{{overviewData.pending > 0}}">{{overviewData.pending}}</view>
      </view>
      <text class="action-title">å¾…å¤„ç†é—®é¢˜</text>
      <text class="action-desc">æŸ¥çœ‹å¹¶åˆ†é…ä»»åŠ¡ã€å‘é€é…ä»¶ã€å‘é€è¿”ä»¶ã€å®Œæˆä»»åŠ¡</text>
    </view>
    
    <view class="action-item" bindtap="onGoResolved">
      <view class="action-icon resolved-icon">
        <text class="icon">ğŸ“Š</text>
      </view>
      <text class="action-title">å·²è§£å†³åˆ—è¡¨</text>
      <text class="action-desc">æŸ¥çœ‹å®Œæˆæƒ…å†µ</text>
    </view>
    
    <view class="action-item" bindtap="onGoStatistics">
      <view class="action-icon statistics-icon">
        <text class="icon">ğŸ“ˆ</text>
      </view>
      <text class="action-title">æ•°æ®ç»Ÿè®¡</text>
      <text class="action-desc">åˆ†æå¤„ç†æ•°æ®</text>
    </view>

    <view class="action-item" bindtap="onGoFeedback">
      <view class="action-icon feedback-icon">
        <text class="icon">ğŸ’¬</text>
      </view>
      <text class="action-title">é—®é¢˜åé¦ˆ</text>
      <text class="action-desc">æäº¤æ–°çš„é—®é¢˜åé¦ˆ</text>
    </view>
    
    <view class="action-item" bindtap="onGoRatingFeedback">
      <view class="action-icon rating-icon">
        <text class="icon">â­</text>
        <view class="badge-count" wx:if="{{overviewData.pendingRatings > 0}}">{{overviewData.pendingRatings}}</view>
      </view>
      <text class="action-title">è¯„åˆ†åé¦ˆ</text>
      <text class="action-desc">å¯¹å·²å®Œæˆå·¥å•è¿›è¡Œè¯„ä»·</text>
    </view>

    <view class="action-item" bindtap="onGoWorkerApplications">
      <view class="action-icon worker-app-icon">
        <text class="icon">ğŸ”§</text>
      </view>
      <text class="action-title">ç»´ä¿®å·¥ç”³è¯·</text>
      <text class="action-desc">å®¡æ ¸ç»´ä¿®å·¥åŠ å…¥ç”³è¯·</text>
    </view>

    <view class="action-item" bindtap="onGoWorkerList">
      <view class="action-icon worker-list-icon">
        <text class="icon">ğŸ‘·</text>
      </view>
      <text class="action-title">ç»´ä¿®å·¥åˆ—è¡¨</text>
      <text class="action-desc">æŸ¥çœ‹æ‰€æœ‰ç»´ä¿®å·¥ä¿¡æ¯</text>
    </view>
  </view>

  <!-- ç´§æ€¥é—®é¢˜æé†’ -->
  <view class="urgent-section" wx:if="{{urgentIssues.length > 0}}">
    <view class="section-title">
      <text class="title-text">ç´§æ€¥é—®é¢˜</text>
      <view class="urgent-badge">{{urgentIssues.length}}</view>
    </view>
    
    <view class="urgent-list">
      <view 
        class="urgent-item" 
        wx:for="{{urgentIssues}}" 
        wx:key="id"
        bindtap="onViewUrgentIssue"
        data-id="{{item.id}}"
      >
        <view class="urgent-header">
          <text class="urgent-title">{{item.title}}</text>
          <view class="priority-tag priority-high">éå¸¸ç´§æ€¥</view>
        </view>
        <text class="urgent-desc">{{item.description}}</text>
        <view class="urgent-meta">
          <text class="urgent-time">{{item.createTime}}</text>
          <text class="urgent-id">#{{item.id}}</text>
        </view>
      </view>
    </view>
  </view>

  <!-- æœ€è¿‘å¤„ç† -->
  <view class="recent-section">
    <view class="section-title">
      <text class="title-text">æœ€è¿‘å¤„ç†</text>
      <text class="title-more" bindtap="onViewAllRecent">æŸ¥çœ‹å…¨éƒ¨</text>
    </view>
    
    <view class="recent-list" wx:if="{{recentIssues.length > 0}}">
      <view 
        class="recent-item" 
        wx:for="{{recentIssues}}" 
        wx:key="id"
        bindtap="onViewRecentIssue"
        data-id="{{item.id}}"
      >
        <view class="recent-header">
          <text class="recent-title">{{item.title}}</text>
          <view class="status-tag status-{{item.status}}">
            {{item.statusText}}
          </view>
        </view>
        <view class="recent-meta">
          <text class="recent-assignee">å¤„ç†äººï¼š{{item.assignee}}</text>
          <text class="recent-time">{{item.updateTime}}</text>
        </view>
      </view>
    </view>
    
    <view class="empty-state" wx:else>
      <text class="empty-icon">ğŸ“</text>
      <text class="empty-text">æš‚æ— æœ€è¿‘å¤„ç†è®°å½•</text>
    </view>
  </view>
</view>