<!--pages/client/problem/issues/issues.wxml-->
<view class="container">
  <view class="worker-header user-mode">
    <view class="header-content">
      <text class="greeting">故障报修</text>
      <text class="subtitle">请准确填写您的设备故障信息</text>
    </view>
    <image class="header-bg-icon" src="/images/icons/worker.png" mode="aspectFit"></image>
  </view>

  <view class="form-container">
    <view class="form-title">报修单信息</view>
    
    <view class="form-item">
      <text class="label"><text class="required">*</text>设备码 (SN/IMEI)</text>
      <input class="input" placeholder="请输入或扫描设备条码" value="{{formData.sn}}" bindinput="onInputChange" data-field="sn" />
      <image class="scan-icon" src="/images/icons/scan.png" bindtap="onScanSN"></image>
    </view>

    <view class="form-item">
      <text class="label"><text class="required">*</text>联系电话</text>
      <input class="input" type="number" placeholder="请输入您的手机号码" value="{{formData.phone}}" bindinput="onInputChange" data-field="phone" />
    </view>

    <view class="form-item">
      <text class="label"><text class="required">*</text>故障现象描述</text>
      <textarea class="textarea" placeholder="请详细描述设备出现的故障现象..." value="{{formData.description}}" bindinput="onInputChange" data-field="description" maxlength="200"></textarea>
    </view>

    <view class="form-item">
      <text class="label">附件图片 (可选)</text>
      <view class="image-uploader">
        <block wx:for="{{tempImages}}" wx:key="*this">
          <view class="image-wrap">
            <image class="preview-img" src="{{item}}" mode="aspectFill" bindtap="onPreviewImage" data-url="{{item}}"></image>
            <view class="remove-btn" bindtap="onRemoveImage" data-index="{{index}}">×</view>
          </view>
        </block>
        <view class="upload-btn" bindtap="onChooseImage" wx:if="{{tempImages.length < 4}}">
          <view class="plus">+</view>
          <text>添加图片</text>
        </view>
      </view>
      <text class="tip">最多上传4张图片</text>
    </view>

    <button class="submit-btn" bindtap="onSubmitReport">提交报修申请</button>
  </view>
</view>