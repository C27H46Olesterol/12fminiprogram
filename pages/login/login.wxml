<!--pages/login/login.wxml-->
<view class="login-container">
  <!-- 背景装饰 -->
  <view class="bg-decoration">
    <view class="circle circle-1"></view>
    <view class="circle circle-2"></view>
    <view class="circle circle-3"></view>
  </view>

  <!-- 登录内容 -->
  <view class="login-content">
    <!-- Logo和标题 -->
    <view class="header">
      <view class="logo">
        <image class="logo-image" src="/images/logo.png" mode="aspectFit"></image>
      </view>
    </view>

    <!-- 登录表单 -->
    <view class="card login-form">
      <!-- 微信授权获取手机号登录按钮 -->
      <button 
        class="get-phone-btn" 
        open-type="getPhoneNumber"
        bindgetphonenumber="wxLogin"
        disabled="{{loading}}"
      >
        <view class="btn-content flex flex-center">
          <image class="wechat-icon" src="/images/icons/phone.png" mode="aspectFit"></image>
          <text class="btn-text">{{loading ? '登录中...' : '手机号授权快速登录'}}</text>
        </view>
      </button>



      <!-- 用户协议勾选 -->
      <view class="agreement-row" bindtap="toggleAgreement">
        <view class="checkbox {{agreed ? 'checked' : ''}}">
          <icon wx:if="{{agreed}}" type="success_no_circle" size="12" color="#fff" />
        </view>
        <view class="agreement-text">
          <text>我已阅读并同意</text>
          <text class="link" catchtap="showUserAgreement">《用户协议》</text>
          <text>和</text>
          <text class="link" catchtap="showPrivacyPolicy">《隐私政策》</text>
        </view>
      </view>
    </view>
  </view>

  <!-- 协议弹窗 -->
  <view class="modal-overlay {{showAgreementModal ? 'show' : ''}}" bindtap="closeModal">
    <view class="agreement-modal" catchtap="noOp">
      <view class="modal-header">
        <text class="modal-title">{{modalTitle}}</text>
        <view class="close-btn" bindtap="closeModal">×</view>
      </view>
      <scroll-view scroll-y class="modal-body">
        <text class="agreement-content">{{modalContent}}</text>
      </scroll-view>
      <view class="modal-footer">
        <button class="agree-btn" bindtap="agreeAndClose">同意并继续</button>
      </view>
    </view>
  </view>
</view>