<!--pages/profile/resign/resign.wxml-->
<view class="container">
  <!-- 头部 -->
  <view class="header-section">
    <view class="header-bg"></view>
    <view class="header-content">
      <view class="header-title">申请成为维修工</view>
      <view class="header-desc">请填写真实的店铺信息以通过审核</view>
    </view>
  </view>

  <!-- 表单容器 -->
  <view class="form-container">
    <view class="form-card">
      <view class="card-title">店铺信息</view>
      <!-- 姓名 -->
      <view class="form-group">
        <view class="form-label">
          <text>姓名</text>
          <text class="required-mark">*</text>
        </view>
        <input 
          class="form-input" 
          type="text" 
          placeholder="请输入您的姓名" 
          placeholder-class="input-placeholder"
          value="{{formData.userName}}" 
          bindinput="onUserNameInput"
        />
      </view>

      <!-- 联系方式 -->
      <view class="form-group">
        <view class="form-label">
          <text>联系方式</text>
          <text class="required-mark">*</text>
        </view>
        <input 
          class="form-input" 
          type="number" 
          placeholder="请输入您的联系电话" 
          placeholder-class="input-placeholder"
          value="{{formData.contactPhone}}" 
          bindinput="onContactPhoneInput"
        />
      </view>

      <!-- 店面名称 -->
      <view class="form-group">
        <view class="form-label">
          <text>店面名称</text>
          <text class="required-mark">*</text>
        </view>
        <input 
          class="form-input" 
          type="text" 
          placeholder="请输入您的店面名称" 
          placeholder-class="input-placeholder"
          value="{{formData.storeName}}" 
          bindinput="onStoreNameInput"
        />
      </view>

      <!-- 店面地址 -->
      <view class="form-group">
        <view class="form-label">
          <text>店面地址</text>
          <text class="required-mark">*</text>
        </view>
        <input 
          class="form-input" 
          type="text" 
          placeholder="请输入详细地址" 
          placeholder-class="input-placeholder"
          value="{{formData.storeAddress}}" 
          bindinput="onStoreAddressInput"
        />
      </view>
    </view>

    <view class="form-card">
      <view class="card-title">资质证明</view>

      <!-- 店面照片 -->
      <view class="form-group">
        <view class="form-label">
          <text>店面照片</text>
          <text class="required-mark">*</text>
          <text class="label-desc">请上传门头照或店内环境照</text>
        </view>
        <view class="image-upload-area">
          <view 
            class="uploaded-item" 
            wx:for="{{formData.storeImages}}" 
            wx:key="*this"
          >
            <image 
              class="uploaded-img" 
              src="{{item}}" 
              mode="aspectFill"
              bindtap="onPreviewStoreImage"
              data-url="{{item}}"
            />
            <view class="delete-btn" catchtap="onDeleteStoreImage" data-index="{{index}}">
              <text class="delete-icon">×</text>
            </view>
          </view>
          
          <view class="upload-btn" bindtap="onChooseStoreImage" wx:if="{{formData.storeImages.length < 3}}">
            <view class="upload-icon-wrap">
              <text class="upload-icon">+</text>
            </view>
            <text class="upload-text">上传照片</text>
          </view>
        </view>
      </view>

      <!-- 营业执照 -->
      <view class="form-group no-border">
        <view class="form-label">
          <text>营业执照</text>
          <text class="required-mark">*</text>
          <text class="label-desc">请上传清晰的营业执照照片</text>
        </view>
        <view class="image-upload-area">
          <view 
            class="uploaded-item" 
            wx:for="{{formData.licenseImages}}" 
            wx:key="*this"
          >
            <image 
              class="uploaded-img" 
              src="{{item}}" 
              mode="aspectFill"
              bindtap="onPreviewLicenseImage"
              data-url="{{item}}"
            />
            <view class="delete-btn" catchtap="onDeleteLicenseImage" data-index="{{index}}">
              <text class="delete-icon">×</text>
            </view>
          </view>
          
          <view class="upload-btn" bindtap="onChooseLicenseImage" wx:if="{{formData.licenseImages.length < 1}}">
            <view class="upload-icon-wrap">
              <text class="upload-icon">+</text>
            </view>
            <text class="upload-text">上传执照</text>
          </view>
        </view>
      </view>
    </view>

    <!-- 经销商绑定 -->
    <view class="form-card">
      <view class="card-title">绑定经销商</view>
      <view class="search-box">
        <input 
          class="form-input flex-1" 
          type="number" 
          placeholder="请输入经销商手机号" 
          placeholder-class="input-placeholder"
          value="{{dealerPhoneSearch}}" 
          bindinput="onDealerPhoneInput"
        />
        <button class="btn-search" bindtap="onSearchDealer" loading="{{isSearchingDealer}}">查询</button>
      </view>
      
      <!-- 经销商查询结果展示 -->
      <view class="dealer-info-card" wx:if="{{selectedDealer}}">
        <view class="dealer-info-item">
          <text class="dealer-label">经销商姓名：</text>
          <text class="dealer-value">{{selectedDealer.nickName || selectedDealer.userName}}</text>
        </view>
        <view class="dealer-info-item">
          <text class="dealer-label">手机号码：</text>
          <text class="dealer-value">{{selectedDealer.phonenumber}}</text>
        </view>
        <view class="dealer-status">
          <icon type="success" size="14"></icon>
          <text>已验证</text>
        </view>
        <view class="remove-dealer" bindtap="onRemoveDealer">
          <text>重选</text>
        </view>
      </view>
      <view class="search-tip" wx:if="{{!selectedDealer && searchError}}">
        <text class="error-text">{{searchError}}</text>
      </view>
      <view class="search-tip" wx:if="{{!selectedDealer && !searchError}}">
        <text>请输入经销商手机号并点击查询以进行绑定</text>
      </view>
    </view>

    <view class="submit-area">
      <button 
        class="btn-submit" 
        hover-class="btn-hover"
        bindtap="onSubmit"
        disabled="{{isSubmitting || !canSubmit}}"
      >
        {{isSubmitting ? '提交中...' : '提交审核'}}
      </button>
    </view>
  </view>
</view>
